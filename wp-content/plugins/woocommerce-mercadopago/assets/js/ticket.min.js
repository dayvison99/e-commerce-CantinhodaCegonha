!function(e){"use strict";e((function(){var t=!1,o="CPF",r=wc_mercadopago_ticket_params.site_id,c={discount_action_url:wc_mercadopago_ticket_params.discount_action_url,payer_email:wc_mercadopago_ticket_params.payer_email,activated:wc_mercadopago_ticket_params.coupon_mode,status:!1};function n(){return!document.getElementById("payment_method_woo-mercado-pago-ticket").checked||("MLB"===r?(function(){for(var e=document.querySelector("#mercadopago-form-ticket"),t=e.querySelectorAll("[data-checkout]"),o=e.querySelectorAll(".mp-erro_febraban"),r=0;r<t.length;r++){var c=t[r],n=e.querySelector(o[r].getAttribute("data-main"));"none"===c.parentNode.style.display||-1!==c.value&&""!==c.value?(o[r].style.display="none",n.classList.remove("mp-form-control-error")):(o[r].style.display="inline-block",n.classList.add("mp-form-control-error"))}for(var u=0;u<t.length;u++){var a=t[u];if("none"!==a.parentNode.style.display&&(-1===a.value||""===a.value))return a.focus(),!1}return!0}()&&u()?t=!0:a(),t):"MLU"===r?(u()?t=!0:a(),t):void 0)}function u(){var e=document.getElementById("mp_doc_number"),t=document.getElementById("mp_error_docnumber"),c=!1;return"MLB"===r&&(c=function(e){if("CPF"===o)return function(e){var t,o;if(t=0,"00000000000"===(e=e.replace(/[.-\s]/g,"")))return!1;for(var r=1;r<=9;r++)t+=parseInt(e.substring(r-1,r),10)*(11-r);10!=(o=10*t%11)&&11!==o||(o=0);if(o!==parseInt(e.substring(9,10),10))return!1;t=0;for(var c=1;c<=10;c++)t+=parseInt(e.substring(c-1,c),10)*(12-c);10!=(o=10*t%11)&&11!==o||(o=0);if(o!==parseInt(e.substring(10,11),10))return!1;return!0}(e);return function(e){if(""===(e=e.replace(/[^\d]+/g,"")))return!1;if(14!==e.length)return!1;if("00000000000000"===e||"11111111111111"===e||"22222222222222"===e||"33333333333333"===e||"44444444444444"===e||"55555555555555"===e||"66666666666666"===e||"77777777777777"===e||"88888888888888"===e||"99999999999999"===e)return!1;for(var t=e.length-2,o=e.substring(0,t),r=e.substring(t),c=0,n=t-7,u=t;u>=1;u--)c+=o.charAt(t-u)*n--,n<2&&(n=9);var a=c%11<2?0:11-c%11;if(a.toString()!==r[0])return!1;for(t+=1,o=e.substring(0,t),c=0,n=t-7,u=t;u>=1;u--)c+=o.charAt(t-u)*n--,n<2&&(n=9);if((a=c%11<2?0:11-c%11).toString()!==r[1])return!1;return!0}(e)}(e.value)),"MLU"===r&&(c=function(e){if(""!==e)return function(e){var t=0,o=0,r=0,c=e[e.length-1];if(e.length<=6)for(o=e.length;o<7;o++)e="0"+e;for(o=0;o<7;o++)t+=parseInt("2987634"[o],10)*parseInt(e[o],10)%10;r=t%10==0?0:10-t%10;return c===r.toString()}(e);return!1}(e.value)),c?(t.style.display="none",e.classList.remove("mp-form-control-error"),c=!0):(t.style.display="block",e.classList.add("mp-form-control-error"),e.focus()),c}function a(){e("form#order_review").length>0&&e(".blockOverlay").css("display","none")}function l(){document.querySelector("#mpCouponApplyedTicket").style.display="none",""===document.querySelector("#couponCodeTicket").value?(c.status=!1,document.querySelector("#mpCouponErrorTicket").style.display="block",document.querySelector("#mpCouponErrorTicket").innerHTML=wc_mercadopago_ticket_params.coupon_empty,document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#discountTicket").value=0):c.status?(c.status=!1,document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#applyCouponTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#couponCodeTicket").value="",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#discountTicket").value=0):(document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.loading+") 98% 50% no-repeat #fff",document.querySelector("#couponCodeTicket").style.border="1px solid #cecece",document.querySelector("#applyCouponTicket").disabled=!0,function(){var t=c.discount_action_url,o="?";t.indexOf("?")>=0&&(o="&");t+=o+"site_id="+wc_mercadopago_ticket_params.site_id,t+="&coupon_id="+document.querySelector("#couponCodeTicket").value,t+="&amount="+document.querySelector("#amountTicket").value,t+="&payer="+c.payer_email,e.ajax({url:t,method:"GET",timeout:5e3,error:function(){c.status=!1,document.querySelector("#mpCouponApplyedTicket").style.display="none",document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#applyCouponTicket").style.background=null,document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#couponCodeTicket").value="",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#discountTicket").value=0},success:function(e){200===e.status?(c.status=!0,document.querySelector("#mpCouponApplyedTicket").style.display="block",document.querySelector("#discountTicket").value=e.response.coupon_amount,document.querySelector("#mpCouponApplyedTicket").innerHTML=wc_mercadopago_ticket_params.discount_info1+" <strong>"+i(e.response.currency_id)+" "+Math.round(100*e.response.coupon_amount)/100+"</strong> "+wc_mercadopago_ticket_params.discount_info2+" "+e.response.name+".<br>"+wc_mercadopago_ticket_params.discount_info3+" <strong>"+i(e.response.currency_id)+" "+Math.round(100*document.querySelector("#amountTicket").value)/100+"</strong><br>"+wc_mercadopago_ticket_params.discount_info4+" <strong>"+i(e.response.currency_id)+" "+Math.round(100*(document.getElementById("amountTicket").value-document.getElementById("discountTicket").value))/100+"*</strong><br><i>"+wc_mercadopago_ticket_params.discount_info5+'</i><br><a href="https://api.mercadolibre.com/campaigns/'+e.response.id+'/terms_and_conditions?format_type=html" target="_blank">'+wc_mercadopago_ticket_params.discount_info6+"</a>",document.querySelector("#mpCouponErrorTicket").style.display="none",document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.check+") 94% 50% no-repeat #fff",document.querySelector("#couponCodeTicket").style.border="1px solid #cecece",document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.remove,document.querySelector("#campaign_idTicket").value=e.response.id,document.querySelector("#campaignTicket").value=e.response.name):(c.status=!1,document.querySelector("#mpCouponApplyedTicket").style.display="none",document.querySelector("#mpCouponErrorTicket").style.display="block",document.querySelector("#mpCouponErrorTicket").innerHTML=e.response.message,document.querySelector("#couponCodeTicket").style.background=null,document.querySelector("#couponCodeTicket").style.background="url("+wc_mercadopago_ticket_params.error+") 94% 50% no-repeat #fff",document.querySelector("#applyCouponTicket").value=wc_mercadopago_ticket_params.apply,document.querySelector("#discountTicket").value=0),document.querySelector("#applyCouponTicket").disabled=!1}})}())}function i(e){return"ARS"===e?"$":"BRL"===e?"R$":"COP"===e||"CLP"===e||"MXN"===e?"$":"VEF"===e?"Bs":"PEN"===e?"S/":"UYU"===e?"$U":"$"}e("form#order_review").length>0&&"yes"===c.activated&&e("#applyCouponTicket").on("click",l),e("body").on("updated_checkout",(function(){"MLB"===r&&function(){var e=document.getElementById("mp_box_lastname"),t=document.getElementById("mp_box_firstname"),r=document.getElementById("mp_firstname_label"),c=document.getElementById("mp_socialname_label"),n=document.getElementById("mp_cpf_label"),u=document.getElementById("mp_cnpj_label"),a=document.getElementById("mp_doc_number"),l=document.querySelectorAll('input[type=radio][name="mercadopago_ticket[docType]"]');u.style.display="none",c.style.display="none";for(var i=function(){"CPF"===this.value?(n.style.display="block",e.style.display="grid",r.style.display="block",u.style.display="none",c.style.display="none",t.classList.remove("mp-col-md-8"),t.classList.add("mp-col-md-4"),a.setAttribute("maxlength","14"),a.setAttribute("onkeyup","mpMaskInput(this, mpCpf)"),o="CPF"):(n.style.display="none",e.style.display="none",r.style.display="none",u.style.display="block",c.style.display="block",t.classList.remove("mp-col-md-4"),t.classList.add("mp-col-md-8"),a.setAttribute("maxlength","18"),a.setAttribute("onkeyup","mpMaskInput(this, mpCnpj)"),o="CNPJ")},p=0;p<l.length;p++)l[p].addEventListener("change",i)}(),"yes"===c.activated&&e("#applyCouponTicket").on("click",l)})),e("form.checkout").on("checkout_place_order_woo-mercado-pago-ticket",(function(){return n()})),e("form#order_review").submit((function(){return n()}))}))}(jQuery);